<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MDT Map</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="min-h-screen p-6">
    <nav class="sticky-nav mb-6 p-4 bg-gray-900 rounded-lg shadow"></nav>

    <div class="tips">
        <h4 class="text-lg font-semibold">Tips</h4>
        <p>View all properties on the map (PROP001-003). Search by name (e.g., "Axel Apartments"). Click markers for details.</p>
    </div>

    <h3 class="text-xl font-semibold mb-2">Map Overview</h3>
    <div class="bg-gray-800 p-4 rounded-lg mb-4 shadow">
        <input type="text" id="mapSearch" placeholder="Search by property name" class="bg-gray-700 text-white p-2 rounded w-full sm:w-1/3 mb-2">
    </div>
    <div id="map" class="bg-gray-800 p-4 rounded-lg shadow" style="height: 500px;"></div>

    <div id="alert" class="fixed top-4 right-4 bg-green-600 text-white p-4 rounded shadow hidden"></div>

    <script src="scripts.js"></script>
    <script src="common.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap" async defer></script>
    <script>
        let map, markers = [];

        function initMap() {
            loadData(() => {
                map = new google.maps.Map(document.getElementById('map'), {
                    center: { lat: 37.7749, lng: -122.4194 }, // Default: San Francisco
                    zoom: 12
                });

                propertiesData.forEach(prop => {
                    if (prop.address) {
                        const marker = new google.maps.Marker({
                            position: { lat: parseFloat(prop.lat || 37.7749), lng: parseFloat(prop.lng || -122.4194) },
                            map: map,
                            title: prop.propertyName
                        });
                        marker.addListener('click', () => {
                            if (['PROP001', 'PROP002', 'PROP003'].includes(prop.id)) {
                                window.location.href = `${prop.id.toLowerCase()}.html`;
                            } else {
                                showAlert(`${prop.propertyName}: ${prop.address}`, 'bg-blue-600');
                            }
                        });
                        markers.push(marker);
                    }
                });

                document.getElementById('mapSearch').addEventListener('input', (e) => {
                    const search = e.target.value.toLowerCase();
                    markers.forEach(marker => {
                        const title = marker.getTitle().toLowerCase();
                        marker.setVisible(search === '' || title.includes(search));
                    });
                });
            });
        }
    </script>
</body>
</html>
